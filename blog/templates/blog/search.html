{% extends "blog/base.html" %}
{% load blog_tags %}
{% load static %}
{% block title %}Search{% endblock %}

{% block content %}
  {% if query %}
    <h1>Posts containing "{{ query }}"</h1>
    <h3>
      {% with results.count as total_results %}
          Found {{ total_results }} result{{ total_results|pluralize }}
      {% endwith %}
    </h3>
    {% for post in results %}
            <div class="row justify-content-center ">
                  <a href="{% url 'post_detail_func' post.pk %}"
                     class="btn btn-outline-secondary next-post margin">
                      <h2 class="margin">{{post.title}}</h2>
                            {% if post.photo %}

                                <img class="img-text smallphoto" src="{{post.photo.url}}" alt="My image">

                            {% else %}
                                <img class="img-text smallphoto" src="{% static 'blog/panda.jpg' %}" alt="My image">
                            {% endif %}

                            <p class="margin">{{post.text|markdown|truncatewords_html:30}}<p class="margin">
                            Tags: {{post.tags.all|join:", " }}
                            </p>
                            <p class="margin">{{post.comments.count}} comments
                            </p>
                  </a>

            </div>
    {% empty %}
      <p>There are no results for your query.</p>
    {% endfor %}
    <p><a href="{% url "post_search" %}">Search again</a></p>
  {% else %}
    <h1>Search for posts</h1>
    <form action="." method="get">
      {{ form.as_p }}
      <input type="submit" value="Search">
    </form>
  {% endif %}
{% endblock %}